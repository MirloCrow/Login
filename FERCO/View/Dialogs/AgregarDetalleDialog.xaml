<Window x:Class="FERCO.View.Dialogs.AgregarDetalleDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:FERCO.ViewModel"
        mc:Ignorable="d"
        Title="Agregar Producto"
        Height="550" Width="850"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{StaticResource PrimaryBackgroundBrush}">

    <Window.DataContext>
        <vm:AgregarDetalleDialogViewModel />
    </Window.DataContext>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Filtro -->
        <StackPanel Orientation="Horizontal">
            <ComboBox Width="150"
                      SelectedIndex="{Binding IndiceFiltroSeleccionado}"
                      Margin="0,0,10,0">
                <ComboBoxItem Content="Nombre"/>
                <ComboBoxItem Content="Código"/>
                <ComboBoxItem Content="Categoría"/>
            </ComboBox>

            <Grid>
                <TextBox Width="250" Margin="0,0,10,0"
                         Text="{Binding TextoBusqueda, UpdateSourceTrigger=PropertyChanged}"
                         Visibility="{Binding EsFiltroPorCategoria, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>

                <ComboBox Width="250" Margin="0,0,10,0"
                          ItemsSource="{Binding Categorias}"
                          DisplayMemberPath="NombreCategoria"
                          SelectedValuePath="NombreCategoria"
                          SelectedValue="{Binding TextoBusqueda, UpdateSourceTrigger=PropertyChanged}"
                          Visibility="{Binding EsFiltroPorCategoria, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            </Grid>

            <ToggleButton Content="⬆⬇ A-Z / Z-A"
                          Margin="0,0,10,0"
                          IsChecked="{Binding OrdenDescendente}"
                          VerticalAlignment="Center"/>

            <Button Content="Buscar"
                    Width="100"
                    Command="{Binding BuscarCommand}"/>
        </StackPanel>

        <!-- Resultados -->
        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding ProductosFiltrados}"
                  SelectedItem="{Binding ProductoSeleccionado}"
                  AutoGenerateColumns="False"
                  Margin="0,10,0,10"
                  Height="300"
                  IsReadOnly="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Nombre" Binding="{Binding NombreProducto}" Width="2*" />
                <DataGridTextColumn Header="Descripción" Binding="{Binding DescripcionProducto}" Width="2.5*" />
                <DataGridTextColumn Header="Precio" Binding="{Binding PrecioProducto}" Width="*" />
                <DataGridTextColumn Header="Categoría" Binding="{Binding NombreCategoria}" Width="1.5*" />
                <DataGridTextColumn Header="Proveedor" Binding="{Binding NombreProveedor}" Width="1.5*" />
            </DataGrid.Columns>
        </DataGrid>

        <!-- Detalles -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0" HorizontalAlignment="Center">
            <TextBlock Text="Cantidad:" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBox Width="80" Text="{Binding Cantidad}" Margin="0,0,20,0"/>

            <TextBlock Text="Precio Unitario:" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBox Width="100" Text="{Binding PrecioUnitario}" Margin="0,0,20,0"/>
        </StackPanel>

        <!-- Botones -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Cancelar" Width="80" Margin="0,0,10,0"
                    Click="Cancelar_Click" Style="{StaticResource BTNHEADERSTYLE}"/>
            <Button Content="Aceptar" Width="80"
                    Click="Aceptar_Click" Style="{StaticResource BTNHEADERSTYLE}"/>
        </StackPanel>
    </Grid>
</Window>
